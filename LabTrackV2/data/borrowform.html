<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="borrowform.css">
    <title>CATS-LabTrack</title>
</head>
<body>
<div class="container">
    <h2>CATS-LabTrack Borrow</h2>
    <input type="email" id="student" placeholder="Student's Email">
    <input type="email" id="prof" placeholder="Professor's Email">
    <input type="text" id="items" placeholder="Item IDs (PSA-01, PSA-02...)">
    
    <button id="btn" onclick="submit()">GENERATE</button>
    <div id="status"></div>
</div>
<script>
function submit() {
    const btn = document.getElementById('btn');
    const status = document.getElementById('status');
    const payload = {
        student_email: document.getElementById('student').value,
        prof_email: document.getElementById('prof').value,
        group_members: "N/A",
        items: document.getElementById('items').value
    };
    
    btn.disabled = true; btn.innerText = "Processing...";
    
    fetch('/generate', { method: 'POST', body: JSON.stringify(payload) })
    .then(r => r.json())
    .then(d => {
        if(d.success) {
            document.body.innerHTML = "<div class='container'><h1>üçû</h1><h2>TAP CARD NOW</h2><p>Transaction: "+d.uid+"</p><button onclick='location.reload()'>Next</button></div>";
        }
    });
}
</script>
</body>
</html>